

##
namespace = admech_vassalisation
##


#start
#target
country_event = {
	id = admech_vassalisation.1
	title = admech_vassalisation.1.t
	desc = admech_vassalisation.1.desc
	picture = TRADEGOODS_eventPicture				#edit
	
	is_triggered_only = yes
	
	immediate = {
		ROOT = {
			add_country_modifier = {
				name = admech_active_negotiation
				duration = -1
			}
		}
		FROM = {
			add_country_modifier = {
				name = admech_active_negotiation
				duration = -1
			}
		}
	}

	#reject request - player only
	option = {
		name = admech_vassalisation.1.a
		FROM = {
			country_event = { 
				id = admech_vassalisation.2
				days = 3
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				ai = yes
			}
		}
	}
	#negotiate - we will make demands
	option = {
		name = admech_vassalisation.1.b
		FROM = {
			country_event = {
				id = admech_vassalisation.3
				days = 3
			}
		}
		ai_chance = {
			factor = 50
		}
	}
}

#innitiator - player rejects request for negotiation - info only
country_event = {
	id = admech_vassalisation.2
	title = admech_vassalisation.2.t
	desc = admech_vassalisation.2.desc
	picture = TRADEGOODS_eventPicture				#edit
	
	is_triggered_only = yes
	
	immediate = {
		ROOT = {
			remove_country_modifier = admech_active_negotiation 
		}
		FROM = {
			remove_country_modifier = admech_active_negotiation
		}
	}
	
	#they refuse
	option = {
		name = admech_vassalisation.2.a	
		add_country_modifier = {
			name = admech_vassalisation_refused
			duration = 730
		}
		add_country_modifier = {
			name = admech_vassalisation_cooldown
			duration = 1825
		}		
		ai_chance = {
			factor = 100
			modifier = {

			}
		}
	}
}

#innitiator - target wants negotiations
country_event = {
	id = admech_vassalisation.3
	title = admech_vassalisation.3.t
	desc = admech_vassalisation.3.desc
	picture = TRADEGOODS_eventPicture				#edit
	
	is_triggered_only = yes
	
	#we offer nothing
	option = {
		name = admech_vassalisation.3.a
		FROM = {
			add_country_modifier = {
				name = admech_vassalisation_offer_0
				duration = 180
				hidden = yes
			}
			country_event = { 
				id = admech_vassalisation.4
				days = 3
			}
		}
		custom_tooltip = TT_admech_vassalisation_offer_0
		ai_chance = {
			factor = 10
			modifier = {

			}
		}
	}
	#we offer SMALL concessions
	option = {
		name = admech_vassalisation.3.b
		FROM = {
			add_country_modifier = {
				name = admech_vassalisation_offer_1
				duration = 180
				hidden = yes
			}
			country_event = { 
				id = admech_vassalisation.4
				days = 3
			}
		}
		custom_tooltip = TT_admech_vassalisation_offer_1
		ai_chance = {
			factor = 20
			modifier = {

			}
		}
	}
	#we offer MEDIUM concessions
	option = {
		name = admech_vassalisation.3.c
		FROM = {
			add_country_modifier = {
				name = admech_vassalisation_offer_2
				duration = 180
				hidden = yes
			}
			country_event = { 
				id = admech_vassalisation.4
				days = 3
			}
		}
		custom_tooltip = TT_admech_vassalisation_offer_2
		ai_chance = {
			factor = 50
			modifier = {

			}
		}
	}
	#we offer LARGE concessions
	option = {
		name = admech_vassalisation.3.d
		FROM = {
			add_country_modifier = {
				name = admech_vassalisation_offer_3
				duration = 180
				hidden = yes
			}
			country_event = { 
				id = admech_vassalisation.4
				days = 3
			}
		}
		custom_tooltip = TT_admech_vassalisation_offer_3
		ai_chance = {
			factor = 20
			modifier = {

			}
		}
	}
}

#target - they make an offer 
country_event = {
	id = admech_vassalisation.4
	title = admech_vassalisation.4.t
	desc = admech_vassalisation.4.desc
	picture = TRADEGOODS_eventPicture				#edit
	
	is_triggered_only = yes
	
	#accept
	option = {
		name = admech_vassalisation.4.a
		FROM = {
			country_event = { 
				id = admech_vassalisation.5
				days = 3
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 15
				has_country_modifier = admech_vassalisation_offer_0		#15%
			}
			modifier = {
				factor = 35
				has_country_modifier = admech_vassalisation_offer_1		#35%
			}
			modifier = {
				factor = 65
				has_country_modifier = admech_vassalisation_offer_2		#65%
			}
			modifier = {
				factor = 100
				has_country_modifier = admech_vassalisation_offer_3		#100%
			}
		}
	}

	#reject
	option = {
		name = admech_vassalisation.4.b
		FROM = {
			country_event = { 
				id = admech_vassalisation.6
				days = 3
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 85
				has_country_modifier = admech_vassalisation_offer_0
			}
			modifier = {
				factor = 65
				has_country_modifier = admech_vassalisation_offer_1
			}
			modifier = {
				factor = 35
				has_country_modifier = admech_vassalisation_offer_2
			}
			modifier = {
				factor = 0
				has_country_modifier = admech_vassalisation_offer_3
			}
		}
	}
}

#innitiator - they accept
country_event = {
	id = admech_vassalisation.5
	title = admech_vassalisation.5.t
	desc = admech_vassalisation.5.desc
	picture = TRADEGOODS_eventPicture				#edit
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			ROOT = {
				remove_country_modifier = admech_active_negotiation 
			}
			FROM = {
				remove_country_modifier = admech_active_negotiation
			}
			
			set_variable = {
				which = admech_vassalisation_cost
				value = 0
			}
			change_variable = {
				which = admech_vassalisation_cost
				value = 0
			}
			export_to_variable = {
				which = admech_vassalisation_cost
				value = total_development
				who = FROM
			}
			multiply_variable = {
				which = admech_vassalisation_cost
				value = 1
			}
			if = {
				limit = {
					FROM = {
						has_country_modifier = admech_vassalisation_offer_0
					}
				}
				multiply_variable = {
					which = admech_vassalisation_cost
					value = 0.75
				}
			}
			if = {
				limit = {
					FROM = {
						has_country_modifier = admech_vassalisation_offer_1
					}
				}
				multiply_variable = {
					which = admech_vassalisation_cost
					value = 1
				}
			}
			if = {
				limit = {
					FROM = {
						has_country_modifier = admech_vassalisation_offer_2
					}
				}
				multiply_variable = {
					which = admech_vassalisation_cost
					value = 1.25
				}
			}
			if = {
				limit = {
					FROM = {
						has_country_modifier = admech_vassalisation_offer_3
					}
				}
				multiply_variable = {
					which = admech_vassalisation_cost
					value = 1.5
				}
			}
		}
	}
	
	#pay the price
	option = {
		name = admech_vassalisation.5.a
			create_subject = {
				subject_type = integrated_forgeworld
				subject = FROM
			}
			
			#the price
			if = { limit = { 		 	check_variable = { which = admech_vassalisation_cost value = 300 } }
				add_adm_power = -400 add_dip_power = -400 add_mil_power = -400
			}
			if = { limit = { AND = {	check_variable = { which = admech_vassalisation_cost value = 250 } }
										NOT = { check_variable = { which = admech_vassalisation_cost value = 300 }}}
				add_adm_power = -350 add_dip_power = -350 add_mil_power = -350
			}
			if = { limit = { AND = {	check_variable = { which = admech_vassalisation_cost value = 200 } }
										NOT = { check_variable = { which = admech_vassalisation_cost value = 250 }}}
				add_adm_power = -300 add_dip_power = -300 add_mil_power = -300
			}
			if = { limit = { AND = {	check_variable = { which = admech_vassalisation_cost value = 150 } }
										NOT = { check_variable = { which = admech_vassalisation_cost value = 200 }}}
				add_adm_power = -250 add_dip_power = -250 add_mil_power = -250
			}
			if = { limit = { AND = { 	check_variable = { which = admech_vassalisation_cost value = 100 } }
										NOT = { check_variable = { which = admech_vassalisation_cost value = 150 }}}
				add_adm_power = -200 add_dip_power = -200 add_mil_power = -200
			}
			if = { limit = { AND = { 	check_variable = { which = admech_vassalisation_cost value = 50 } }
										NOT = { check_variable = { which = admech_vassalisation_cost value = 100 }}}
				add_adm_power = -150 add_dip_power = -150 add_mil_power = -150
			}
			if = { limit = { AND = { 	check_variable = { which = admech_vassalisation_cost value = 25 } } 
										NOT = { check_variable = { which = admech_vassalisation_cost value = 50 }}}
				add_adm_power = -100 add_dip_power = -100 add_mil_power = -100
			}
			if = { limit = { NOT = { check_variable = { which = admech_vassalisation_cost value = 25 } } }
				add_adm_power = -50 add_dip_power = -50 add_mil_power = -50			#base cost
			}
			
			#the price - end
			
			if = {
				limit = { NOT = { has_country_flag = admech_ambitious_forge_world } }
				add_country_modifier = {
					name = admech_vassalisation_cooldown
					duration = 3650
				}
				add_country_modifier = {
					name = admech_vassalisation_demands
					duration = 3650
				}
			}
			if = {
				limit = { has_country_flag = admech_ambitious_forge_world }
				add_country_modifier = {
					name = admech_vassalisation_cooldown
					duration = 1825
				}
				add_country_modifier = {
					name = admech_vassalisation_demands
					duration = 1825
				}
			}
		
		ai_chance = {
			factor = 100
		}
	}
}

#innitiator - they reject
country_event = {
	id = admech_vassalisation.6
	title = admech_vassalisation.6.t
	desc = admech_vassalisation.6.desc
	picture = TRADEGOODS_eventPicture				#edit
	
	is_triggered_only = yes
	
	immediate = {
		ROOT = {
			remove_country_modifier = admech_active_negotiation 
		}
		FROM = {
			remove_country_modifier = admech_active_negotiation
		}
	}
	
	#we'll get them next time
	option = {
		name = admech_vassalisation.6.a
		add_country_modifier = {
			name = admech_vassalisation_refused
			duration = 730
		}
		add_country_modifier = {
			name = admech_vassalisation_cooldown
			duration = 1825
		}
		ai_chance = {
			factor = 100
		}
	}
}
